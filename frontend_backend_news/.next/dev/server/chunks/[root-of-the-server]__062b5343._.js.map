{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 190, "column": 0}, "map": {"version":3,"sources":["file:///D:/LTFE_Projects/lt_frontend_cuoiky/frontend_backend_news/src/app/api/bongdaplus/scrapers/news.ts"],"sourcesContent":["import * as cheerio from 'cheerio';\r\nimport { News } from '../types';\r\n// import { Article } from '../types';\r\n\r\nexport function scrapeNews($: cheerio.CheerioAPI): News[] {\r\n  const newsList: News[] = [];\r\n\r\n  $('ul.lst li.news').each((i, el) => {\r\n    const $item = $(el);\r\n    const $titleAnchor = $item.find('a.title');\r\n\r\n    const title = $titleAnchor.text().trim();\r\n    const href = $titleAnchor.attr('href') ? $titleAnchor.attr('href').trim() : '';\r\n    const imageUrl = $item.find('.thumb img').attr('src') || '';\r\n\r\n    if (title && href) {\r\n      // 1. Tìm vị trí của tin tức có tiêu đề trùng lặp trong danh sách hiện tại\r\n      const existingIndex = newsList.findIndex(news => news.title === title);\r\n\r\n      if (existingIndex > -1) {\r\n        // 2. Nếu ĐÃ TRÙNG: Kiểm tra nếu cái mới có ảnh, thì thay thế cái cũ\r\n        if (imageUrl) {\r\n          const parts = href.split('/').filter(Boolean);\r\n          newsList[existingIndex] = {\r\n            title: title,\r\n            link: href,\r\n            imageUrl: imageUrl,\r\n            category: parts[0] || '',\r\n            root: '/' + (parts[0] || '')\r\n          };\r\n        }\r\n        // Nếu cái mới không có ảnh, ta giữ nguyên cái cũ (không làm gì cả)\r\n      } else {\r\n        // 3. Nếu CHƯA TRÙNG: Thêm mới bình thường\r\n        const parts = href.split('/').filter(Boolean);\r\n        newsList.push({\r\n          title: title,\r\n          link: href,\r\n          imageUrl: imageUrl,\r\n          category: parts[0] || '',\r\n          root: '/' + (parts[0] || '')\r\n        });\r\n      }\r\n    }\r\n  });\r\n\r\n  return newsList;\r\n}\r\n"],"names":[],"mappings":";;;;AAIO,SAAS,WAAW,CAAqB;IAC9C,MAAM,WAAmB,EAAE;IAE3B,EAAE,kBAAkB,IAAI,CAAC,CAAC,GAAG;QAC3B,MAAM,QAAQ,EAAE;QAChB,MAAM,eAAe,MAAM,IAAI,CAAC;QAEhC,MAAM,QAAQ,aAAa,IAAI,GAAG,IAAI;QACtC,MAAM,OAAO,aAAa,IAAI,CAAC,UAAU,aAAa,IAAI,CAAC,QAAQ,IAAI,KAAK;QAC5E,MAAM,WAAW,MAAM,IAAI,CAAC,cAAc,IAAI,CAAC,UAAU;QAEzD,IAAI,SAAS,MAAM;YACjB,0EAA0E;YAC1E,MAAM,gBAAgB,SAAS,SAAS,CAAC,CAAA,OAAQ,KAAK,KAAK,KAAK;YAEhE,IAAI,gBAAgB,CAAC,GAAG;gBACtB,oEAAoE;gBACpE,IAAI,UAAU;oBACZ,MAAM,QAAQ,KAAK,KAAK,CAAC,KAAK,MAAM,CAAC;oBACrC,QAAQ,CAAC,cAAc,GAAG;wBACxB,OAAO;wBACP,MAAM;wBACN,UAAU;wBACV,UAAU,KAAK,CAAC,EAAE,IAAI;wBACtB,MAAM,MAAM,CAAC,KAAK,CAAC,EAAE,IAAI,EAAE;oBAC7B;gBACF;YACA,mEAAmE;YACrE,OAAO;gBACL,0CAA0C;gBAC1C,MAAM,QAAQ,KAAK,KAAK,CAAC,KAAK,MAAM,CAAC;gBACrC,SAAS,IAAI,CAAC;oBACZ,OAAO;oBACP,MAAM;oBACN,UAAU;oBACV,UAAU,KAAK,CAAC,EAAE,IAAI;oBACtB,MAAM,MAAM,CAAC,KAAK,CAAC,EAAE,IAAI,EAAE;gBAC7B;YACF;QACF;IACF;IAEA,OAAO;AACT"}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":["file:///D:/LTFE_Projects/lt_frontend_cuoiky/frontend_backend_news/src/app/api/bongdaplus/scrapers/pupSchedule.ts"],"sourcesContent":["import axios from 'axios';\r\n// import { json } from 'stream/consumers';\r\n// import { UpcomingMatch } from '../types'\r\n// Giả định bạn đã có URL đầy đủ từ bước 1\r\nconst JSON_URL = `https://data.bongdaplus.vn/data/top-list-matches.json?_=${Date.now()}`; \r\n//console.log(JSON_URL)\r\nexport async function fetchUpcomingMatches() {\r\n  try {\r\n    const response = await axios.get(JSON_URL);\r\n    const rawData = response.data; \r\n   // console.log('rawdata:', JSON.stringify(rawData, null, 2));\r\n    \r\n     const matches = rawData.map(item => ({\r\n      leagueLogo : item.tournament.tournament_logo,\r\n      leagueId : item.tournament.tournament_id,\r\n      \r\n      link: `https://bongdaplus.vn/truc-tiep-mfiws1aoh0uztg4/manchester-united-vs-newcastle-united-7kbz8ilusx8or9b.html`,\r\n      starttime: item.start_time,\r\n      homeTeam: {\r\n        name: item.home_name,\r\n        logo: `https://data.bongdaplus.vn/logo/${item.home_logo}`,\r\n      },\r\n      awayTeam: {\r\n        name: item.away_name,\r\n        logo: `https://data.bongdaplus.vn/logo/${item.away_logo}`,\r\n      },\r\n    }));\r\n    return matches\r\n  } catch (error) {\r\n  //  console.error('Lỗi khi tải file JSON:', error);\r\n  }\r\n}\r\nfetchUpcomingMatches();\r\n"],"names":[],"mappings":";;;;AAAA;;AACA,2CAA2C;AAC3C,2CAA2C;AAC3C,0CAA0C;AAC1C,MAAM,WAAW,CAAC,wDAAwD,EAAE,KAAK,GAAG,IAAI;AAEjF,eAAe;IACpB,IAAI;QACF,MAAM,WAAW,MAAM,2KAAK,CAAC,GAAG,CAAC;QACjC,MAAM,UAAU,SAAS,IAAI;QAC9B,6DAA6D;QAE3D,MAAM,UAAU,QAAQ,GAAG,CAAC,CAAA,OAAQ,CAAC;gBACpC,YAAa,KAAK,UAAU,CAAC,eAAe;gBAC5C,UAAW,KAAK,UAAU,CAAC,aAAa;gBAExC,MAAM,CAAC,0GAA0G,CAAC;gBAClH,WAAW,KAAK,UAAU;gBAC1B,UAAU;oBACR,MAAM,KAAK,SAAS;oBACpB,MAAM,CAAC,gCAAgC,EAAE,KAAK,SAAS,EAAE;gBAC3D;gBACA,UAAU;oBACR,MAAM,KAAK,SAAS;oBACpB,MAAM,CAAC,gCAAgC,EAAE,KAAK,SAAS,EAAE;gBAC3D;YACF,CAAC;QACD,OAAO;IACT,EAAE,OAAO,OAAO;IAChB,mDAAmD;IACnD;AACF;AACA"}},
    {"offset": {"line": 354, "column": 0}, "map": {"version":3,"sources":["file:///D:/LTFE_Projects/lt_frontend_cuoiky/frontend_backend_news/src/app/api/bongdaplus/scrapers/Article.ts"],"sourcesContent":["import * as cheerio from 'cheerio';\r\nimport { News } from '../types';\r\nimport { Article } from '../types';\r\nimport { ChildArticle } from '../types';\r\n\r\nexport function scrapeArticle($: cheerio.CheerioAPI): Article[] {\r\n        const articleList: Article[] = [];\r\n      \r\n        $('div.menu-side > ul.bar-w > li').each((i, el) => {\r\n\r\n            const $item = $(el);\r\n      //    console.log(`Nội dung thô của li thứ ${i}:`, $(el).text().trim());\r\n            const $titleAnchor = $item.find('> a')\r\n\r\n            const category = $titleAnchor.text();\r\n         //    console.log(`Đang quét Menu Cha: ${category}`);\r\n            const href = $titleAnchor.attr('href') || '';\r\n            const subArticleList: ChildArticle[] = [];\r\n            const $dropDown = $item.find('div.drop-down');\r\n        if ($dropDown.length > 0) {\r\n            const $subItems = $item.find('ul.lst li a');\r\n        //    console.log($subItems.text())\r\n            $subItems.each((subIdx, subEl) => {\r\n                const $subAnchor = $(subEl);\r\n                const subTitle = $subAnchor.attr('title') || $subAnchor.text().trim();\r\n                const subHref = $subAnchor.attr('href') || '';\r\n\r\n                if (subTitle) {\r\n                    subArticleList.push({\r\n                        child_title: subTitle,\r\n                        child_source_link: `https://bongdaplus.vn${subHref}`,\r\n                    });\r\n                }\r\n            });\r\n        }\r\n        if (category) {\r\n            articleList.push({\r\n                source_Link: `https://bongdaplus.vn${href}`,\r\n                title: category,\r\n                child_Article: subArticleList\r\n            });\r\n        }\r\n        });\r\n        return articleList;\r\n    }\r\n"],"names":[],"mappings":";;;;AAKO,SAAS,cAAc,CAAqB;IAC3C,MAAM,cAAyB,EAAE;IAEjC,EAAE,iCAAiC,IAAI,CAAC,CAAC,GAAG;QAExC,MAAM,QAAQ,EAAE;QACtB,wEAAwE;QAClE,MAAM,eAAe,MAAM,IAAI,CAAC;QAEhC,MAAM,WAAW,aAAa,IAAI;QACrC,qDAAqD;QAClD,MAAM,OAAO,aAAa,IAAI,CAAC,WAAW;QAC1C,MAAM,iBAAiC,EAAE;QACzC,MAAM,YAAY,MAAM,IAAI,CAAC;QACjC,IAAI,UAAU,MAAM,GAAG,GAAG;YACtB,MAAM,YAAY,MAAM,IAAI,CAAC;YACjC,mCAAmC;YAC/B,UAAU,IAAI,CAAC,CAAC,QAAQ;gBACpB,MAAM,aAAa,EAAE;gBACrB,MAAM,WAAW,WAAW,IAAI,CAAC,YAAY,WAAW,IAAI,GAAG,IAAI;gBACnE,MAAM,UAAU,WAAW,IAAI,CAAC,WAAW;gBAE3C,IAAI,UAAU;oBACV,eAAe,IAAI,CAAC;wBAChB,aAAa;wBACb,mBAAmB,CAAC,qBAAqB,EAAE,SAAS;oBACxD;gBACJ;YACJ;QACJ;QACA,IAAI,UAAU;YACV,YAAY,IAAI,CAAC;gBACb,aAAa,CAAC,qBAAqB,EAAE,MAAM;gBAC3C,OAAO;gBACP,eAAe;YACnB;QACJ;IACA;IACA,OAAO;AACX"}},
    {"offset": {"line": 398, "column": 0}, "map": {"version":3,"sources":["file:///D:/LTFE_Projects/lt_frontend_cuoiky/frontend_backend_news/src/app/api/bongdaplus/scrapers/Ranking.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst LEAGUES = [\r\n   { id: 'premier-league', name: 'Ngoại Hạng Anh', url: `https://data.bongdaplus.vn/data/bong-da-anh-rankings.json?_=${Date.now()}` },\r\n  { id: 'la-liga', name: 'Tây Ban Nha', url: `https://data.bongdaplus.vn/data/bong-da-tay-ban-nha-rankings.json?_=${Date.now()}` },\r\n{ id: 'v-league', name: 'V-League', url: `https://data.bongdaplus.vn/data/bong-da-viet-nam-rankings.json?_=${Date.now()}` },\r\n  {id: 'bundesliga', name: 'Đức', url: `https://data.bongdaplus.vn/data/bong-da-duc-rankings.json?_=${Date.now()}`},\r\n {id: 'league-1', name: 'Pháp', url: `https://data.bongdaplus.vn/data/bong-da-phap-rankings.json?_=${Date.now()}`},\r\n {id: 'serie-A', name: 'Ý', url: `https://data.bongdaplus.vn/data/bong-da-y-rankings.json?_=${Date.now()}`}\r\n\r\n];\r\n\r\nexport async function fetchLeagueRanking() {\r\n  let leagueName = ''\r\n  try {\r\n    // 2. Tạo danh sách các lời hứa (Promises)\r\n    const requests = LEAGUES.map(async league => {\r\n\r\n        const response = await axios.get(league.url);\r\n        leagueName = league.name\r\n        const rawData = response.data;\r\n        const dataMap = rawData.ranks\r\n//        console.log(dataMap)\r\n        const standings = dataMap.map(item => ({\r\n          nameTeam: item.team_name ,\r\n          teamLogo : `https://data.bongdaplus.vn/logo/${item.team_logo}` || '',\r\n          rank : item.position ,\r\n          matches : item.matches ,\r\n          win: item.wins ,\r\n          losses : item.losses ,\r\n          draws: item.draws ,\r\n          ghiban : item.scores_for ,\r\n          thung_luoi : item.scores_against ,\r\n          hieu_so : item.scores_diff ,\r\n          point : item.points ,\r\n\r\n    }));\r\n    return {\r\n        league_name: league.id,\r\n        league_nation: league.name,\r\n        standings: standings\r\n      };\r\n    });\r\n    const finalData = await Promise.all(requests);\r\n    return finalData;\r\n  } catch (error) {\r\n    console.error(\"Lỗi hệ thống:\", error);\r\n    console.log(\"lỗi nằm ở league: \" , leagueName)\r\n    return []\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,UAAU;IACb;QAAE,IAAI;QAAkB,MAAM;QAAkB,KAAK,CAAC,4DAA4D,EAAE,KAAK,GAAG,IAAI;IAAC;IAClI;QAAE,IAAI;QAAW,MAAM;QAAe,KAAK,CAAC,oEAAoE,EAAE,KAAK,GAAG,IAAI;IAAC;IACjI;QAAE,IAAI;QAAY,MAAM;QAAY,KAAK,CAAC,iEAAiE,EAAE,KAAK,GAAG,IAAI;IAAC;IACxH;QAAC,IAAI;QAAc,MAAM;QAAO,KAAK,CAAC,4DAA4D,EAAE,KAAK,GAAG,IAAI;IAAA;IACjH;QAAC,IAAI;QAAY,MAAM;QAAQ,KAAK,CAAC,6DAA6D,EAAE,KAAK,GAAG,IAAI;IAAA;IAChH;QAAC,IAAI;QAAW,MAAM;QAAK,KAAK,CAAC,0DAA0D,EAAE,KAAK,GAAG,IAAI;IAAA;CAEzG;AAEM,eAAe;IACpB,IAAI,aAAa;IACjB,IAAI;QACF,0CAA0C;QAC1C,MAAM,WAAW,QAAQ,GAAG,CAAC,OAAM;YAE/B,MAAM,WAAW,MAAM,2KAAK,CAAC,GAAG,CAAC,OAAO,GAAG;YAC3C,aAAa,OAAO,IAAI;YACxB,MAAM,UAAU,SAAS,IAAI;YAC7B,MAAM,UAAU,QAAQ,KAAK;YACrC,8BAA8B;YACtB,MAAM,YAAY,QAAQ,GAAG,CAAC,CAAA,OAAQ,CAAC;oBACrC,UAAU,KAAK,SAAS;oBACxB,UAAW,CAAC,gCAAgC,EAAE,KAAK,SAAS,EAAE,IAAI;oBAClE,MAAO,KAAK,QAAQ;oBACpB,SAAU,KAAK,OAAO;oBACtB,KAAK,KAAK,IAAI;oBACd,QAAS,KAAK,MAAM;oBACpB,OAAO,KAAK,KAAK;oBACjB,QAAS,KAAK,UAAU;oBACxB,YAAa,KAAK,cAAc;oBAChC,SAAU,KAAK,WAAW;oBAC1B,OAAQ,KAAK,MAAM;gBAEzB,CAAC;YACD,OAAO;gBACH,aAAa,OAAO,EAAE;gBACtB,eAAe,OAAO,IAAI;gBAC1B,WAAW;YACb;QACF;QACA,MAAM,YAAY,MAAM,QAAQ,GAAG,CAAC;QACpC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,QAAQ,GAAG,CAAC,sBAAuB;QACnC,OAAO,EAAE;IACX;AACF"}},
    {"offset": {"line": 477, "column": 0}, "map": {"version":3,"sources":["file:///D:/LTFE_Projects/lt_frontend_cuoiky/frontend_backend_news/src/app/api/bongdaplus/route.ts"],"sourcesContent":["// src/app/api/bongdaplus/route.ts\r\nimport { NextRequest, NextResponse } from 'next/server';\r\nimport * as cheerio from 'cheerio';\r\nimport { scrapeNews } from './scrapers/news';\r\nimport { fetchUpcomingMatches } from './scrapers/pupSchedule';\r\nimport { scrapeArticle } from './scrapers/Article';\r\nimport { fetchLeagueRanking } from './scrapers/Ranking';\r\n\r\n//dinh nghia cors\r\nconst corsHeaders = {\r\n  'Access-Control-Allow-Origin': '*', // Cho phép tất cả các domain (localhost:5173, v.v...)\r\n  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\r\n  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\r\n  'Cache-Control': 's-maxage=600', // Giữ nguyên cache của bạn\r\n};\r\n\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const res = await fetch('https://bongdaplus.vn', {\r\n      headers: { 'User-Agent': 'Mozilla/5.0 (compatible; BongDaPlus Scraper)' },\r\n    });\r\n\r\n    if (!res.ok) throw new Error(`Fetch failed: ${res.status}`);\r\n\r\n    const $ = cheerio.load(await res.text());\r\n\r\n    // Lấy từng loại dữ liệu\r\n    const news = scrapeNews($);\r\n    const upcomingMatches = await fetchUpcomingMatches();\r\n    const article = scrapeArticle($)\r\n    const standing = await fetchLeagueRanking()\r\n    return Response.json(\r\n      {\r\n        success: true,\r\n        data: {\r\n          article,\r\n          news,\r\n          upcomingMatches,\r\n          standing,\r\n          // Thêm các phần khác sau này: standings, results, videos...\r\n        },\r\n      },\r\n      {status : 200,\r\n        headers : corsHeaders\r\n      }\r\n    );\r\n  } catch (error) {\r\n    console.log(\"lỗi header : \", error)\r\n    return Response.json(\r\n      {\r\n        success: false,\r\n        error: (error as Error).message,\r\n      },\r\n      { status: 500, \r\n        headers: corsHeaders\r\n      }\r\n    );\r\n  }\r\n}"],"names":[],"mappings":"AAAA,kCAAkC;;;;;AAElC;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEA,iBAAiB;AACjB,MAAM,cAAc;IAClB,+BAA+B;IAC/B,gCAAgC;IAChC,gCAAgC;IAChC,iBAAiB;AACnB;AAGO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,yBAAyB;YAC/C,SAAS;gBAAE,cAAc;YAA+C;QAC1E;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,CAAC,cAAc,EAAE,IAAI,MAAM,EAAE;QAE1D,MAAM,IAAI,0LAAY,CAAC,MAAM,IAAI,IAAI;QAErC,wBAAwB;QACxB,MAAM,OAAO,IAAA,4LAAU,EAAC;QACxB,MAAM,kBAAkB,MAAM,IAAA,6MAAoB;QAClD,MAAM,UAAU,IAAA,kMAAa,EAAC;QAC9B,MAAM,WAAW,MAAM,IAAA,uMAAkB;QACzC,OAAO,SAAS,IAAI,CAClB;YACE,SAAS;YACT,MAAM;gBACJ;gBACA;gBACA;gBACA;YAEF;QACF,GACA;YAAC,QAAS;YACR,SAAU;QACZ;IAEJ,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC,iBAAiB;QAC7B,OAAO,SAAS,IAAI,CAClB;YACE,SAAS;YACT,OAAO,AAAC,MAAgB,OAAO;QACjC,GACA;YAAE,QAAQ;YACR,SAAS;QACX;IAEJ;AACF"}}]
}