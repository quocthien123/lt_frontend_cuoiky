{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file:///D:/1ky-1-nam-4/frontend_cuoiky/frontend_backend_news/src/app/api/get-category/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport * as cheerio from 'cheerio';\r\nimport { Article } from '../bongdaplus/types';\r\n\r\n// Headers để tránh lỗi CORS\r\nconst corsHeaders = {\r\n  'Access-Control-Allow-Origin': '*',\r\n  'Access-Control-Allow-Methods': 'GET, OPTIONS',\r\n  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\r\n};\r\n\r\nexport interface Article_News {\r\n    title: string,\r\n    img_url: string,\r\n    dateTime : string,\r\n    url : string,\r\n}\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n // const searchParams = request.nextUrl.searchParams;\r\n // const slug = searchParams.get('slug');\r\n // if (!slug) {\r\n  //  return NextResponse.json(\r\n   //   { success: false, message: 'Thiếu slug' },\r\n   //   { status: 400, headers: corsHeaders }\r\n  //  );\r\n//  }\r\n        //https://bongdaplus.vn/bong-da-viet-nam\r\n  const urlToScrape = `https://bongdaplus.vn/bong-da-viet-nam`;\r\n\r\n  console.log(`Đang cào dữ liệu từ: ${urlToScrape}`);\r\nconst res = await fetch(urlToScrape, {\r\n      headers: { 'User-Agent': 'Mozilla/5.0 (compatible; MyScraper)' },\r\n    });\r\n\r\n    if (!res.ok) throw new Error('Không thể truy cập trang đích');\r\n  const html = await res.text();\r\n    const $ = cheerio.load(html);\r\n\r\n    const articles_news: Article_News[] = []\r\n\r\n    $('.cat-news .news').each((i, el) => {\r\n        \r\n        const $el = $(el)\r\n\r\n        const title = $el.find('a.title').text()\r\n\r\n        const img_url = $el.find('.thumb img').attr('src') || ''\r\n\r\n        const  dateTime = $el.find('.info span').text()\r\n\r\n        const url = $el.find('a.title').attr('href') \r\n\r\n\r\n        articles_news.push({\r\n            title,\r\n            img_url,\r\n            dateTime,\r\n            url,\r\n        })\r\n\r\n\r\n    })\r\n      return NextResponse.json(\r\n      {\r\n        success: true,\r\n        data: {\r\n            articles_news\r\n        },\r\n      },\r\n      {status : 200,\r\n        headers : corsHeaders\r\n      }\r\n    );\r\n  } catch (error) {\r\n    console.log(\"lỗi header : \", error)\r\n    return NextResponse.json(\r\n      {\r\n        success: false,\r\n        error: (error as Error).message,\r\n      },\r\n      { status: 500, \r\n        headers: corsHeaders\r\n      }\r\n    );\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAGA,4BAA4B;AAC5B,MAAM,cAAc;IAClB,+BAA+B;IAC/B,gCAAgC;IAChC,gCAAgC;AAClC;AASO,eAAe,IAAI,OAAoB;IAC1C,IAAI;QACP,qDAAqD;QACrD,yCAAyC;QACzC,eAAe;QACd,6BAA6B;QAC5B,+CAA+C;QAC/C,0CAA0C;QAC3C,MAAM;QACR,KAAK;QACG,wCAAwC;QAC9C,MAAM,cAAc,CAAC,sCAAsC,CAAC;QAE5D,QAAQ,GAAG,CAAC,CAAC,qBAAqB,EAAE,aAAa;QACnD,MAAM,MAAM,MAAM,MAAM,aAAa;YAC/B,SAAS;gBAAE,cAAc;YAAsC;QACjE;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;QAC/B,MAAM,OAAO,MAAM,IAAI,IAAI;QACzB,MAAM,IAAI,0LAAY,CAAC;QAEvB,MAAM,gBAAgC,EAAE;QAExC,EAAE,mBAAmB,IAAI,CAAC,CAAC,GAAG;YAE1B,MAAM,MAAM,EAAE;YAEd,MAAM,QAAQ,IAAI,IAAI,CAAC,WAAW,IAAI;YAEtC,MAAM,UAAU,IAAI,IAAI,CAAC,cAAc,IAAI,CAAC,UAAU;YAEtD,MAAO,WAAW,IAAI,IAAI,CAAC,cAAc,IAAI;YAE7C,MAAM,MAAM,IAAI,IAAI,CAAC,WAAW,IAAI,CAAC;YAGrC,cAAc,IAAI,CAAC;gBACf;gBACA;gBACA;gBACA;YACJ;QAGJ;QACE,OAAO,yKAAY,CAAC,IAAI,CACxB;YACE,SAAS;YACT,MAAM;gBACF;YACJ;QACF,GACA;YAAC,QAAS;YACR,SAAU;QACZ;IAEJ,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC,iBAAiB;QAC7B,OAAO,yKAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,OAAO,AAAC,MAAgB,OAAO;QACjC,GACA;YAAE,QAAQ;YACR,SAAS;QACX;IAEJ;AACF"}}]
}